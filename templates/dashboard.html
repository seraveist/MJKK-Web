<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë§ˆì‘ í†µê³„ ëŒ€ì‹œë³´ë“œ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 2rem;
            background-color: #f9f9f9;
        }
        h1, h2 {
            margin-top: 2rem;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        th, td {
            padding: 8px 12px;
            border: 1px solid #ccc;
            text-align: left;
        }
        th {
            background-color: #eee;
        }
        select {
            padding: 6px;
            font-size: 1rem;
        }
    </style>
</head>
<body>
    <h1>ë§ˆì‘ í†µê³„ ëŒ€ì‹œë³´ë“œ</h1>

    <label for="playerSelect">í”Œë ˆì´ì–´ ì„ íƒ:</label>
    <select id="playerSelect">
        <option value="">-- ì„ íƒí•˜ì„¸ìš” --</option>
    </select>

    <div id="statsTableContainer"></div>

    <h2>ì—­ ë‹¬ì„± ìˆ˜</h2>
    <div id="yakuTableContainer"></div>

    <script>
        const fields = {
            "name": "í”Œë ˆì´ì–´",
            "games": "ëŒ€êµ­ ìˆ˜",
            "total_first_count": "1ìœ„ìœ¨",
            "total_second_count": "2ìœ„ìœ¨",
            "total_third_count": "3ìœ„ìœ¨",
            "total_fourth_count": "4ìœ„ìœ¨",
            "total.avg": "í‰ê· ìˆœìœ„",
            "east.avg": "ë™",
            "south.avg": "ë‚¨",
            "west.avg": "ì„œ",
            "north.avg": "ë¶",
            "endScore.avg": "ìµœì¢… ì ìˆ˜ í‰ê· ",
            "endScore.max": "ìµœì¢… ì ìˆ˜ ìµœê³ ",
            "endScore.min": "ìµœì¢… ì ìˆ˜ ìµœì €",
            "minusScore.avg": "í† ë¹„ìœ¨",
            "minusScore.sum": "í† íƒˆ í† ë¹„ ìˆ˜",
            "minusOther.avg": "íƒ€ê°€ ë“¤í†µë¥ ",
            "minusOther.sum": "íƒ€ê°€ ë“¤í†µ ì´í•©",
            "minusOther.plr": "íƒ€ê°€ ë“¤í†µ ì¸ì›ìˆ˜",
            "dora.avg": "í‰ê·  ì „ì²´ ë„ë¼ê°¯ìˆ˜",
            "dora.per": "ì „ì²´ ë„ë¼ìœ¨",
            "dora.max": "ìµœëŒ€ ì „ì²´ ë„ë¼ê°¯ìˆ˜",
            "dora_outer.avg": "í‰ê·  ë„ë¼ê°¯ìˆ˜",
            "dora_outer.per": "ë„ë¼ìœ¨",
            "dora_outer.max": "ìµœëŒ€ ë„ë¼ê°¯ìˆ˜",
            "dora_inner.avg": "í‰ê·  ë’·ë„ë¼ê°¯ìˆ˜",
            "dora_inner.per": "ë’·ë„ë¼ìœ¨",
            "dora_inner.max": "ìµœëŒ€ ë’·ë„ë¼ê°¯ìˆ˜",
            "dora_inner_eff.avg": "ë’·ë„ë¼ í‰ê·  ë³€í™”ì ",
            "dora_inner_eff.per": "ë’·ë„ë¼ ìœ íš¨ìœ¨",
            "dora_inner_eff.max": "ë’·ë„ë¼ ìµœëŒ€ ë³€í™”ì ",
            "dora_akai.avg": "í‰ê·  ì ë„ë¼ê°¯ìˆ˜",
            "dora_akai.per": "ì ë„ë¼ìœ¨",
            "dora_akai.max": "ìµœëŒ€ ì ë„ë¼ê°¯ìˆ˜",
            "winGame.avg": "í™”ë£Œìœ¨",
            "winGame.len": "í™”ë£Œ ìˆ˜",
            "winGame_score.avg": "í‰ê·  íƒ€ì ",
            "winGame_score.max": "ìµœëŒ€ íƒ€ì ",
            "winGame_host.avg": "ì˜¤ì•¼ í‰ê·  íƒ€ì ",
            "winGame_host.max": "ì˜¤ì•¼ ìµœëŒ€ íƒ€ì ",
            "winGame_host.per": "ì˜¤ì•¼ í™”ë£Œìœ¨",
            "winGame_zimo.avg": "ì¯”ëª¨ í‰ê· ì ",
            "winGame_zimo.max": "ì¯”ëª¨ ìµœëŒ€ì ",
            "winGame_zimo.per": "ì¯”ëª¨ìœ¨",
            "winGame_rong.avg": "ë¡  í‰ê· ì ",
            "winGame_rong.max": "ë¡  ìµœëŒ€ì ",
            "winGame_rong.per": "ë¡ ìœ¨",
            "winGame_fulu.avg": "í›„ë¡œ í™”ë£Œ í‰ê· ",
            "winGame_fulu.max": "í›„ë¡œ í™”ë£Œ ìµœëŒ€",
            "winGame_fulu.per": "í›„ë¡œ í™”ë£Œìœ¨",
            "winGame_richi.avg": "ë¦¬ì¹˜ í™”ë£Œ í‰ê· ",
            "winGame_richi.max": "ë¦¬ì¹˜ í™”ë£Œ ìµœëŒ€",
            "winGame_richi.per": "ë¦¬ì¹˜ í™”ë£Œìœ¨",
            "winGame_dama.avg": "ë‹¤ë§ˆ í™”ë£Œ í‰ê· ",
            "winGame_dama.max": "ë‹¤ë§ˆ í™”ë£Œ ìµœëŒ€",
            "winGame_dama.per": "ë‹¤ë§ˆìœ¨",
            "winGame_round.avg": "í‰ê·  í™”ë£Œ ìˆœìˆ˜",
            "winGame_round.min": "ìµœì†Œ í™”ë£Œ ìˆœìˆ˜",
            "fulu.avg": "í›„ë¡œìœ¨",
            "fulu.len": "í›„ë¡œ ìˆ˜",
            "fulu_winGame.per": "í›„ë¡œì‹œ í™”ë£Œìœ¨",
            "fulu_score.avg": "í›„ë¡œ ìˆ˜ì§€ í‰ê· ",
            "fulu_score.max": "í›„ë¡œ ìˆ˜ì§€ ìµœëŒ€",
            "fulu_score.min": "í›„ë¡œ ìˆ˜ì§€ ìµœì†Œ",
            "fulu_zimo.avg": "í›„ë¡œ ì¯”ëª¨ í‰ê· ",
            "fulu_zimo.max": "í›„ë¡œ ì¯”ëª¨ ìµœëŒ€",
            "fulu_zimo.per": "í›„ë¡œ ì¯”ëª¨ìœ¨",
            "fulu_rong.avg": "í›„ë¡œ ë¡  í‰ê· ",
            "fulu_rong.max": "í›„ë¡œ ë¡  ìµœëŒ€",
            "fulu_rong.per": "í›„ë¡œ ë¡ ìœ¨",
            "fulu_chong.avg": "í›„ë¡œ ë°©ì´ í‰ê· ",
            "fulu_chong.min": "í›„ë¡œ ë°©ì´ ìµœì†Œ",
            "fulu_chong.per": "í›„ë¡œ ë°©ì´ë¥ ",
            "chong.avg": "ë°©ì´ë¥ ",
            "chong.len": "ë°©ì´ ìˆ˜",
            "chong_score.avg": "í‰ê·  ë°©ì´ì ",
            "chong_score.min": "ìµœì†Œ ë°©ì´ì ",
            "chong_host.avg": "ì˜¤ì•¼ ë°©ì´ í‰ê· ",
            "chong_host.min": "ì˜¤ì•¼ ë°©ì´ ìµœì†Œ",
            "chong_host.per": "ë°©ì´ì‹œ ì˜¤ì•¼ìœ¨",
            "chong_fulu.avg": "ë°©ì´ì‹œ í›„ë¡œ í‰ê· ",
            "chong_fulu.min": "ë°©ì´ì‹œ í›„ë¡œ ìµœì†Œ",
            "chong_fulu.per": "ë°©ì´ì‹œ í›„ë¡œìœ¨",
            "chong_richi.avg": "ë°©ì´ì‹œ ë¦¬ì¹˜ í‰ê· ",
            "chong_richi.min": "ë°©ì´ì‹œ ë¦¬ì¹˜ ìµœì†Œ",
            "chong_richi.per": "ë°©ì´ì‹œ ë¦¬ì¹˜ìœ¨",
            "dehost.avg": "ì˜¤ì•¼ì¹´ë¶€ë¦¬ìœ¨",
            "dehost.len": "ì˜¤ì•¼ì¹´ë¶€ë¦¬ ìˆ˜",
            "dehost_score.avg": "ì˜¤ì•¼ì¹´ë¶€ë¦¬ í‰ê· ì ",
            "dehost_score.min": "ì˜¤ì•¼ì¹´ë¶€ë¦¬ ìµœì†Œì ",
            "otherZimo.avg": "í”¼ì¯”ëª¨ìœ¨",
            "otherZimo.len": "í”¼ì¯”ëª¨ ìˆ˜",
            "otherZimo_score.avg": "í”¼ì¯”ëª¨ í‰ê· ì ",
            "otherZimo_score.min": "í”¼ì¯”ëª¨ ìµœì†Œì ",
            "richi.avg": "ë¦¬ì¹˜ìœ¨",
            "richi.len": "ë¦¬ì¹˜ ìˆ˜",
            "richi_winGame.per": "ë¦¬ì¹˜ ì„±ê³µë¥ ",
            "richi_score.avg": "ë¦¬ì¹˜ ìˆ˜ì§€ í‰ê· ",
            "richi_score.min": "ë¦¬ì¹˜ ìˆ˜ì§€ ìµœì†Œ",
            "richi_score.max": "ë¦¬ì¹˜ ìˆ˜ì§€ ìµœëŒ€",
            "richi_yifa.avg": "ì¼ë°œ í‰ê· ",
            "richi_yifa.max": "ì¼ë°œ ìµœëŒ€",
            "richi_yifa.per": "ì¼ë°œë¥ ",
            "richi_rong.avg": "ë¦¬ì¹˜ ë¡  í‰ê· ",
            "richi_rong.max": "ë¦¬ì¹˜ ë¡  ìµœëŒ€",
            "richi_rong.per": "ë¦¬ì¹˜ì‹œ ë¡ ìœ¨",
            "richi_zimo.avg": "ë¦¬ì¹˜ ì¯”ëª¨ í‰ê· ",
            "richi_zimo.max": "ë¦¬ì¹˜ ì¯”ëª¨ ìµœëŒ€",
            "richi_zimo.per": "ë¦¬ì¹˜ì‹œ ì¯”ëª¨ìœ¨",
            "richi_chong.avg": "ë¦¬ì¹˜ ë°©ì´ í‰ê· ",
            "richi_chong.min": "ë¦¬ì¹˜ ë°©ì´ ìµœì†Œ",
            "richi_chong.per": "ë¦¬ì¹˜ì‹œ ë°©ì´ë¥ ",
            "richi_draw.per": "ë¦¬ì¹˜ì‹œ ìœ êµ­ë¥ ",
            "richi_otherZimo.avg": "ë¦¬ì¹˜ì‹œ íƒ€ê°€ ì¯”ëª¨ í‰ê· ",
            "richi_otherZimo.min": "ë¦¬ì¹˜ì‹œ íƒ€ê°€ ì¯”ëª¨ ìµœì†Œ",
            "richi_otherZimo.per": "ë¦¬ì¹˜ì‹œ íƒ€ê°€ ì¯”ëª¨ìœ¨",
            "richi_machi.avg": "ë¦¬ì¹˜ ëŒ€ê¸° í‰ê· ",
            "richi_machi.per": "ë¦¬ì¹˜ ë‹¤ë©´ìœ¨",
            "richi_first.per": "ë¦¬ì¹˜ ì„ ì œìœ¨"
        };

        document.getElementById('playerSelect').addEventListener('change', async function () {
            const player = this.value;
            const res = await fetch(`/stats/${encodeURIComponent(player)}`);
            const data = await res.json();

            const statsContainer = document.getElementById('statsTableContainer');
            const yakuContainer = document.getElementById('yakuTableContainer');
            statsContainer.innerHTML = "";
            yakuContainer.innerHTML = "";

            // ğŸ“Š í†µê³„ í…Œì´ë¸” ìƒì„±
            const table = document.createElement('table');
            const thead = table.createTHead();
            const headRow = thead.insertRow();
            headRow.insertCell().textContent = "í•­ëª©";
            headRow.insertCell().textContent = "ê°’";

            const tbody = table.createTBody();

            Object.entries(fields).forEach(([key, label]) => {
                const keys = key.split(".");
                let value = data;
                for (const k of keys) {
                    value = value?.[k];
                    if (value === undefined) break;
                }
                if (value !== undefined) {
                    const row = tbody.insertRow();
                    row.insertCell().textContent = label;
                    row.insertCell().textContent = (typeof value === "number") ? value.toFixed(2) : value;
                }
            });

            statsContainer.appendChild(table);

            // ğŸ€„ Yaku í…Œì´ë¸”
            const yakuData = data.yaku;
            if (yakuData && typeof yakuData === "object") {
                const yakuTable = document.createElement('table');
                const yakuHead = yakuTable.createTHead();
                const yakuHeadRow = yakuHead.insertRow();
                yakuHeadRow.insertCell().textContent = "ì—­ ì´ë¦„";
                yakuHeadRow.insertCell().textContent = "ë‹¬ì„± ìˆ˜";

                const yakuBody = yakuTable.createTBody();
                Object.entries(yakuData).forEach(([yakuName, count]) => {
                    const row = yakuBody.insertRow();
                    row.insertCell().textContent = yakuName;
                    row.insertCell().textContent = count;
                });

                yakuContainer.appendChild(yakuTable);
            }
        });

        // ê¸°ë³¸ í”Œë ˆì´ì–´ ëª©ë¡ ë¡œë”© ì˜ˆì‹œ
        window.addEventListener('DOMContentLoaded', async () => {
            const res = await fetch("/players");
            const players = await res.json();
            const select = document.getElementById("playerSelect");
            players.forEach(p => {
                const option = document.createElement("option");
                option.value = p;
                option.textContent = p;
                select.appendChild(option);
            });
        });
    </script>
</body>
</html>
